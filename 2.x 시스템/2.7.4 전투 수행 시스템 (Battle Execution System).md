**[2.7.4 전투 수행 시스템 (Battle Execution System)]**  
**상태:** ✔ 완료 (v1.0)

**1. 개요**  
전투 수행 시스템은 플레이어 명령(오퍼레이터 입력) 이후 각 유닛이 자율적으로 전투를 수행하는 반턴제(Bi-Turn) 시뮬레이션 루프의 핵심이다. 본 시스템은 전투 AI, 전술 로직, 피해·행동 연산, 시각적 피드백, 클레어/아인 개입 연출을 통합한다.

---

**2. 루프 구조 (반턴제 구조)**

- **1단계 – 명령 입력:** 플레이어는 이동·회복·방어 등의 오퍼레이터 명령을 내리며, 판단 모드는 공세적/수세적/임의 중 하나를 선택할 수 있다.
    
- **2단계 – AI 판단:** 각 유닛은 자신의 병종, 특수 능력, 전장 상태, 사거리·시야 정보에 기반하여 행동을 결정한다.
    
- **3단계 – 행동 수행:** 이동 → 공격/지원 → 반응행동(회피·방어) 순으로 연산된다.
    
- **4단계 – 피해 연산:** 공격 성공률, 방어 수치, 지형 보정(고저차), 병종 상성에 따라 피해량이 계산된다.
    
- **5단계 – 피드백 및 갱신:** 체력, 사기, 행동력(AP), 특수 상태(버프·디버프), 광폭화 여부 등이 갱신된다.
    
- **6단계 – 오퍼레이터 개입:** 카드 개입(2.7.3), 명령 보정(2.7.2)이 발생할 수 있으며, 클레어/아인의 개입 연출이 표시된다.
    
- **7단계 – 턴 종료:** 남은 행동 포인트가 없거나 모든 유닛이 행동 완료 시 턴 종료. 다음 턴으로 전환된다.
    

---

**3. 전투 연산 시스템 (Combat Computation Core)**

- **명중 공식:** `HitChance = BaseAcc + SkillMod + TerrainBonus - TargetEvasion`
    
- **피해 공식:** `Damage = (Atk × WeaponCoef) - (Def × ArmorCoef)`
    
- **치명타:** 확률적 발동(`CritChance = LUCK × WeaponCritRate`), 피해량 ×1.5~2.0배
    
- **지형 보정:** 높이 차에 따른 공격 보정(상대보다 높으면 +10% 피해, 낮으면 -10%)
    
- **사기 보정:** 사기(Morale)가 낮을수록 명중률·피해 감소, 반란 상태 시 통제 불가.
    
- **광폭화:** 특정 조건(피해 누적률·동료 사망률)에 따라 버서크 모드 발동, 행동력 및 공격력 증가.
    

---

**4. 전장 요소 및 행동 규칙**

- **시야(LoS):** 은폐물·지형 고저차에 따라 가시선 차단. 정찰병은 시야+2.
    
- **행동 포인트(AP):** 이동·공격·회복·스킬 사용에 소모.
    
- **상태 이상:** 중상, 기절, 과열, 시스템 오류(기계유닛) 등.
    
- **지원 행동:** 지원병·통신병의 회복, 해킹, 드론 호출 가능.
    
- **지형 타입:** 평지(기본), 산악(이동 -1, 방어 +10%), 도시(시야 -1, 명중 -5%), 실내(폭발 피해 +20%).
    

---

**5. 시각 연출 및 UI 피드백**

- 행동 중 HUD에 실시간 로그 출력 (예: “돌격병 A → 적 저격병 B 공격 (Hit: 82%, Dmg: 24)”)
    
- 피격 시 UI 흔들림, 피격선 붉은 이펙트, 체력바 애니메이션 갱신
    
- 클레어/아인 개입 시 우측 하단에 인물창 및 대사 출력
    
- 턴 종료 시 전황 요약(유닛 생존율, 지역 점령률, 남은 턴수 등)
    

---

**6. 루시움 간섭 요소 (Special Rule)**  
루시움이 존재하는 지역에서는 루시움 간섭률(L-Interference Rate)에 따라 확률적으로 예측 불가 현상이 발생:

- **AI 행동 오류**, **명령 지연**, **특수 능력 폭주**, **시간 왜곡(턴 스킵/중첩)**  
    이는 [2.8 시뮬레이션 메타 매니저]의 난이도·불안정도 계산과 연동된다.
    

---

**7. 시스템 연동 구조**

- [2.7.1 오퍼레이터 명령 처리 시스템] → 명령 수집 및 우선순위 결정
    
- [2.7.2 명령 개입 시뮬레이션 플로우] → 클레어/아인 해석 및 개입 타이밍 결정
    
- [2.7.3 오퍼레이터 카드 개입 시스템] → 카드 효과와 연출 적용
    
- [2.8 시뮬레이션 메타 매니저] → 전투 진행 중 글로벌 변수 반영(경제·치안·명성 피드백)
    
- [2.9 시스템 통합 플로우] → 전투 루프와 씬 간 상태 전이 관리
    

---

**8. 향후 확장 계획**

- 전술 모드 추가 (유닛 포메이션 / 협공 시스템)
    
- 환경 상호작용 (폭발물, 연료통, 전력선)
    
- 루시움 이상현상 연출 (시간 왜곡, 공간 왜곡, 행동 반복)
    
- 전투 리플레이 기능 및 로그 기반 시뮬레이션 리뷰
    

---

**비고:**  
본 시스템은 2.7.x 전투 모듈군의 최종 루프 구조를 규정하며, 3.3 전장 HUD와 직접 연결된다.  
루시움 간섭 확률, 전장 시야 시스템, AI 우선순위 트리 등은 차후 [2.8 시뮬레이션 메타 매니저 v1.1]에서 조정된다.